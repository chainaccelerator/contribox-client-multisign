<!doctype html>
<html lang="en-us">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Wallycore shell</title>
  <style>
    textarea {
      font-family: monospace;
      width: 80%;
      padding-right: 0;
      margin-left: auto;
      margin-right: auto;
      display: block;
    }
  </style>
</head>

<body>
  <textarea id="output" rows="8"></textarea>
  {{{ SCRIPT }}}
  <script async type='text/javascript' src='main.js'></script>
  <script defer type='text/javascript'>
    function main() {
      if (init() !== 0) {
        alert("initialization failed");
        return;
      };
      console.log("Libwally successfully initialized\n");
      var password = "this is user password";
      var wallet = newWallet(password);
      if (wallet === "") {
        alert("Wallet creation failed");
        return;
      }
      console.log("encryptedWallet is " + wallet);

      xpub = getXpub(wallet, password);
      console.log("xpub is " + xpub);
      console.log("seed words are " + mnemonic);

      restored = restoreWallet(password, mnemonic);
      restoredXpub = getXpub(restored, password);
      if (restoredXpub.localeCompare(xpub) === 0) {
        console.log("restored wallet is OK ");
      }
      // Try to extract the seed with a wrong password
      var password = "this is not user password";
      mnemonic = getSeed(wallet, password);
    }
    var Module = {
      onRuntimeInitialized: function () {
        main();
      }
    };
  </script>
</body>

</html>